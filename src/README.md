# 模板设计器
## 项目概述
模板设计器是一个功能强大的网页应用，专为表单模板创建、编辑和数据填充打印设计。它采用纯前端技术实现，无需服务器支持，可直接在浏览器中运行。该工具特别适合需要批量生成带有固定背景的文档场景，如证书、许可证、表格等。通过直观的拖拽界面和精确的定位系统，用户可以轻松设计模板并导入数据进行批量打印。

## 核心功能
### 模板设计
- 背景图片管理 ：支持导入各种格式的图片作为模板背景
- 字段系统 ：在模板上添加、编辑、删除和精确定位可编辑字段
- 拖拽与精确定位 ：支持直观拖拽和毫米级精确坐标定位
- 对齐辅助 ：拖动字段时显示对齐辅助线，帮助精确排版
- 字段属性 ：全面的字段属性设置，包括名称、类型、位置、尺寸等
- 字体控制 ：支持设置字体类型、大小、样式（粗体、斜体、下划线）
- 图片字段 ：支持添加图片类型字段，可通过文件选择或Base64数据导入
### 数据处理
- Excel/CSV导入 ：支持导入Excel和CSV格式的数据文件
- 数据预览 ：导入数据后可预览表格内容，确认数据正确性
- 字段映射 ：自动将导入数据与模板字段进行匹配
- 默认值 ：为字段设置默认值，在无数据时显示
- 数据导出 ：将当前模板字段配置导出为Excel格式，便于填充数据
### 模板管理
- 模板保存 ：将完整模板（包含背景图片和字段配置）保存为JSON文件
- 模板导入 ：导入之前保存的模板配置，快速恢复设计
- 本地存储 ：自动保存当前工作状态到浏览器本地存储，防止意外关闭丢失工作
- IndexedDB支持 ：使用IndexedDB存储大型模板数据，包括图片资源
### 打印功能
- 批量打印 ：支持根据导入数据批量生成打印内容
- 打印范围 ：可选择打印全部数据或指定范围
- 打印预览 ：提供直观的打印预览功能
- 套打模式 ：可选择是否打印背景图片，支持套打到预印制表格
- 打印偏移 ：支持设置打印偏移量，微调打印位置
- 缩放控制 ：提供放大和缩小功能，方便编辑和预览
## 技术特点
- 纯前端实现 ：完全使用HTML、CSS和JavaScript实现，无需后端支持
- 响应式设计 ：适应不同屏幕尺寸和分辨率
- 精确单位转换 ：在像素和毫米单位间精确转换，确保打印效果
- 本地数据处理 ：所有数据处理在本地完成，保护数据安全
- 浏览器兼容性 ：支持现代浏览器，优化Chrome、Firefox和Edge体验
- 离线可用 ：一旦加载，可在无网络环境下使用
- 图片处理 ：支持Base64编码的图片数据，便于存储和传输
## 使用指南
### 基本操作流程
1. 创建模板
   
   - 点击"导入背景"按钮，选择一个图片文件作为模板背景
   - 系统会自动根据图片尺寸设置模板大小，也可在弹出的对话框中手动调整
2. 添加和编辑字段
   
   - 点击"添加字段"按钮，在模板上添加一个新字段
   - 拖拽调整字段位置，或在属性面板中输入精确坐标
   - 双击字段可直接编辑字段内容
3. 设置字段属性
   
   - 点击选择字段，在右侧属性面板中设置字段属性：
     - 基本信息：名称、类型（文本、数字、日期、图片）、默认数据
     - 位置与尺寸：X坐标、Y坐标、宽度、高度（单位：毫米）
     - 字体设置：字体类型、大小、样式（粗体、斜体、下划线）
   - 点击"应用"按钮保存属性更改
4. 图片字段处理
   
   - 选择字段类型为"图片"时，可通过"浏览..."按钮选择图片文件
   - 双击图片字段可直接粘贴Base64图片数据
   - 使用"复制Base64"按钮可复制图片的Base64数据
5. 保存模板
   
   - 点击"保存模板"按钮，将模板配置（包括背景图片和字段）保存为JSON文件
   - 保存的模板可以在以后重新导入使用
6. 导入数据
   
   - 点击"导入数据"按钮，选择Excel或CSV文件
   - 在预览窗口中确认数据正确性
   - 点击"确认导入"按钮，数据将根据字段名称自动填充到对应字段
7. 打印
   
   - 点击"打印"按钮，打开打印选项对话框
   - 选择打印范围（全部或指定范围）
   - 设置是否显示背景图片（套打模式）
   - 调整打印偏移量（如需要）
   - 点击"打印"按钮进行打印或预览
### 高级技巧
1. 键盘快捷操作
   
   - 使用方向键微调选中字段的位置
   - 按Delete键快速删除选中的字段
2. 对齐辅助
   
   - 拖动字段时，系统会自动显示对齐辅助线，帮助与其他字段对齐
   - 对齐功能支持左对齐、右对齐、顶部对齐、底部对齐和中心对齐
3. 模板尺寸设置
   
   - 支持常用纸张尺寸（A3、A4、A5、B5）和自定义尺寸
   - 更改模板尺寸时，已有字段会按比例调整位置
4. 字段类型特性
   
   - 文本字段：支持多行文本和基本格式控制
   - 图片字段：支持本地图片文件和Base64编码数据
   - 数字字段：优化数字显示格式
   - 日期字段：支持多种日期格式
## 注意事项
- 数据格式要求 ：导入的Excel/CSV文件表头必须与模板中的字段名称匹配
- 图片字段限制 ：图片字段支持常见图片格式（JPG、PNG、GIF等）
- 浏览器兼容性 ：为获得最佳体验，建议使用最新版本的Chrome、Firefox或Edge浏览器
- 打印效果 ：打印效果可能因浏览器和打印机设置而略有差异，建议先进行打印预览
- 本地存储限制 ：浏览器本地存储和IndexedDB有容量限制，特别大的模板可能需要定期导出保存
- 套打注意事项 ：使用套打模式时，请确保预先放入打印机的表格纸与编辑器中设计的字段位置完全匹配
## 开始使用
1. 打开 排版工具.html 文件即可使用
2. 无需安装其他依赖，支持离线使用
3. 建议使用最新版本的Chrome、Firefox或Edge浏览器
## 技术支持与反馈
如有问题或建议，请联系： 327936559@qq.com